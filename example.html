<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vega Lite Component Example</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
        }
        vega-lite-component {
            height: 400px;
            width: 100%;
            display: block;
            border: 1px solid #ccc;
        }
    </style>
  </head>
  <body>
    <h1>Vega Lite Component Example</h1>
    <p>Below is a Vega-Lite chart managed by a Signal.</p>
    <vega-lite-component id="chart"></vega-lite-component>

    <script type="module">
        import { signal } from '@preact/signals-core';
        import './src/vega-lite-component.ts';

        const chart = document.getElementById('chart');

        const specSignal = signal({
            $schema: 'https://vega.github.io/schema/vega-lite/v5.json',
            description: 'A simple bar chart with embedded data.',
            data: {
                values: [
                    {a: 'A', b: 28}, {a: 'B', b: 55}, {a: 'C', b: 43},
                    {a: 'D', b: 91}, {a: 'E', b: 81}, {a: 'F', b: 53},
                    {a: 'G', b: 19}, {a: 'H', b: 87}, {a: 'I', b: 52}
                ]
            },
            mark: 'bar',
            encoding: {
                x: {field: 'a', type: 'ordinal'},
                y: {field: 'b', type: 'quantitative'}
            }
        });

        // Lit elements properties update when set.
        chart.spec = specSignal;

        console.log("Chart initialized with spec signal.");

        // Simulate update
        setTimeout(() => {
            console.log("Updating chart data via signal...");
            specSignal.value = {
                ...specSignal.value,
                title: "Updated Data",
                data: {
                    values: [
                         {a: 'A', b: 10}, {a: 'B', b: 20}, {a: 'C', b: 30},
                         {a: 'D', b: 40}, {a: 'E', b: 50}
                    ]
                }
            };
        }, 3000);
    </script>
  </body>
</html>
